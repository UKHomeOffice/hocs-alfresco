<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:tns="http://www.activiti.org/test" targetNamespace="http://www.activiti.org/test">
    <collaboration id="FOI_Tribunal">
        <participant id="FOI" name="FOI ICO/Tribunal" processRef="foi_tribunal_complaint_process" />
    </collaboration>
    <process id="foi_tribunal_complaint_process" name="FOI tribunal complaint process" processType="None" isClosed="false" isExecutable="true">
        <startEvent id="StartEvent_1" activiti:formKey="wf:submitGroupReviewTask" />
        <sequenceFlow id="SendToCreateCase" sourceRef="StartEvent_1" targetRef="CreateCase" />
        <userTask id="CreateCase" name="Create Case" activiti:formKey="wf:adhocTask">
            <extensionElements>
                <activiti:taskListener event="create" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
                    <activiti:field name="script">
                        <activiti:string><![CDATA[
                            task.setVariableLocal('bpm_outcomePropertyName',qn.getQname('{http://cts-beta.homeoffice.gov.uk/model/content/1.0}draftResponse'));
                            execution.setVariable('bpm_outcomePropertyName',qn.getQname('{http://cts-beta.homeoffice.gov.uk/model/content/1.0}draftResponse'));
                            for (var i = 0; i < bpm_package.children.length; i++) {
                                execution.setVariable('bpm_case_id', bpm_package.children[i].nodeRef);
                                logger.log("ID: "+execution.getVariable('bpm_case_id')+" Sending to stage: Create Case");
                                bpm_package.children[i].properties['cts:caseStatus'] = 'New';
                                bpm_package.children[i].properties['cts:caseTask'] = 'Create case';
                                bpm_package.children[i].properties['cts:caseWorkflowStatus'] = '{"transitions":[{"label":"Reallocate","value":"Reallocate","manualAllocate":true,"allocateHeader":"Reallocate","colour":"green"},{"label":"Allocate for draft","value":"Next","manualAllocate":true,"allocateHeader":"Allocate for drafting","colour":"green"}],"mandatoryFields":[{"name":"channel","message":"Original channel in the Case details section must be populated"},{"name":"correspondentEmail","message":"Email address in the Requestor details must be populated","expression":"notBlank(case.correspondentEmail) or case.channel !== \'Email\'"},{"name":"correspondentAddressLine1","message":"Address in the Requestor details must be populated","expression":"notBlank(case.correspondentAddressLine1) or case.channel !== \'Post\'"},{"name":"correspondentPostcode","message":"Postcode in the Requestor details must be populated","expression":"notBlank(case.correspondentPostcode) or case.channel !== \'Post\'"},{"name":"correspondentSurname","message":"Last name in the Requestor details section must be populated"},{"name":"markupUnit","message":"Answering Unit in the Markup section must be populated","expression":"notBlank(case.markupUnit) or case.markupDecision === \'No reply needed\' or case.markupDecision ===\'Refer to DCU\'"},{"name":"markupTopic","message":"Topic in the markup section must be populated","expression":"notBlank(case.markupTopic) or case.markupDecision === \'No reply needed\' or case.markupDecision ===\'Refer to DCU\'"}]}';
                                bpm_package.children[i].save();
                                execution.setVariable('bpm_reject_initial_create_user', bpm_package.children[i].properties['cts:assignedUser']);
                                execution.setVariable('bpm_reject_initial_create_team', bpm_package.children[i].properties['cts:assignedTeam']);
                                execution.setVariable('bpm_reject_initial_create_unit', bpm_package.children[i].properties['cts:assignedUnit']);
                            }]]></activiti:string>
                    </activiti:field>
                </activiti:taskListener>
                <activiti:taskListener event="complete" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
                    <activiti:field name="script">
                        <activiti:string><![CDATA[logger.log("ID: "+execution.getVariable('bpm_case_id')+" Exiting stage: Create Case");
                            for (var i = 0; i < bpm_package.children.length; i++) {
                                if (bpm_package.children[i].properties['cts:markupDecision'] == 'No reply needed') {
                                   logger.log("ID: "+execution.getVariable('bpm_case_id')+" Marked for: NRR");
                                   execution.setVariable('bpm_outcome', 'CreateCaseToNRR');
                                } else if (bpm_package.children[i].properties['cts:markupDecision'] == 'Refer to DCU' ||
                                   bpm_package.children[i].properties['cts:markupDecision'] == 'Request unclear') {
                                   logger.log("ID: "+execution.getVariable('bpm_case_id')+" Marked for: OGD");
                                   execution.setVariable('bpm_outcome', 'CreateCaseToOGD');
                                } else{
                                   logger.log("ID: "+execution.getVariable('bpm_case_id')+" Marked for: Draft Response");
                                   execution.setVariable('bpm_outcome', 'SendCreateCaseForDraftResponse');
                                }
                            }]]></activiti:string>
                    </activiti:field>
                </activiti:taskListener>
            </extensionElements>
        </userTask>
        <sequenceFlow id="SendToCreateCaseGateway" sourceRef="CreateCase" targetRef="CreateCaseGateway" />
        <exclusiveGateway id="CreateCaseGateway"/>
        <sequenceFlow id="SendToNRR" sourceRef="CreateCaseGateway" targetRef="NRR">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(bpm_outcome == 'CreateCaseToNRR')}]]></conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="SendToOGD" sourceRef="CreateCaseGateway" targetRef="OGD">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(bpm_outcome == 'CreateCaseToOGD')}]]></conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="SendToDraftResponse" sourceRef="CreateCaseGateway" targetRef="DraftResponse">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(bpm_outcome == 'SendCreateCaseForDraftResponse')}]]></conditionExpression>
        </sequenceFlow>
        <userTask id="DraftResponse" name="Draft Response" activiti:formKey="wf:activitiReviewTask">
            <extensionElements>
                <activiti:taskListener event="create" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
                    <activiti:field name="runAs">
                        <activiti:string><![CDATA[admin]]></activiti:string>
                    </activiti:field>
                    <activiti:field name="script">
                        <activiti:string><![CDATA[logger.log("ID: "+execution.getVariable('bpm_case_id')+" Sending to stage: Draft Response");
                            task.setVariableLocal('bpm_outcomePropertyName',qn.getQname('{http://cts-beta.homeoffice.gov.uk/model/content/1.0}draftResponse'));
                            execution.setVariable('bpm_outcomePropertyName',qn.getQname('{http://cts-beta.homeoffice.gov.uk/model/content/1.0}draftResponse'));
                            for (var i = 0; i < bpm_package.children.length; i++) {
                                logger.log("Draft node:" + bpm_package.children[i].nodeRef);
                                bpm_package.children[i].properties['cts:caseStatus'] = 'Draft';
                                if (bpm_package.children[i].properties['cts:caseTask'] != 'Amend response') {
                                    bpm_package.children[i].properties['cts:caseTask'] = 'Draft response';
                                }
                                //set owner to admin so that users don't keep edit permissions
                                bpm_package.children[i].setOwner('admin');
                                bpm_package.children[i].properties['cts:caseWorkflowStatus'] = '{"transitions":[{"label":"Reallocate","value":"Reallocate","manualAllocate":true,"allocateHeader":"Reallocate","colour":"green"},{"label":"Submit","value":"SendForQA","manualAllocate":true,"allocateHeader":"Allocate for QA review","colour":"green"},{"label":"Return","value":"Reject","manualAllocate":true,"allocateHeader":"Reject","colour":"red"}],"mandatoryFields":[{"name":"hoCaseOfficer","message":"HO case officer is required"},{"name":"answeringMinister","message":"Sign off Minister must be populated when ministerial sign off is required","expression":"notBlank(case.answeringMinister) or form.foiMinisterSignOff !== 1"},{"name":"pitLetterSentDate","message":"The date of the PIT extension letter must be populated","expression":"notBlank(case.pitLetterSentDate) or form.pitExtension !== 1"},{"name":"pitQualifiedExemptions","message":"An appropriate PIT exemption must be selected","expression":"notEmpty(case.pitQualifiedExemptions) or form.pitExtension !== 1"},{"name":"correspondentForename","message":"First name in the Requestor details on the create page must be populated"},{"name":"correspondentSurname","message":"Last name in the Requestor details on the create page must be populated"},{"name":"document","message":"A document with a Response document type must be uploaded","expression":"case.hasCaseDocument(\'Response\') === true"},{"name":"exemptions","message":"Exemptions in the outcome section must be populated","expression":"notEmpty(case.exemptions) or case.markupDecision !== \'Information withheld in full\' and case.markupDecision !== \'Information released in part\'"}]}';
                                bpm_package.children[i].save();
                                execution.setVariable('bpm_reject_initial_draft_user', bpm_package.children[i].properties['cts:assignedUser']);
                                execution.setVariable('bpm_reject_initial_draft_team', bpm_package.children[i].properties['cts:assignedTeam']);
                                execution.setVariable('bpm_reject_initial_draft_unit', bpm_package.children[i].properties['cts:assignedUnit']);
                            }]]></activiti:string>
                    </activiti:field>
                </activiti:taskListener>
                <activiti:taskListener event="complete" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
                    <activiti:field name="script">
                        <activiti:string><![CDATA[logger.log("ID: "+execution.getVariable('bpm_case_id')+" Exiting stage: Draft Response");
                            for (var i = 0; i < bpm_package.children.length; i++) {
                                if (task.getVariableLocal('cts_draftResponse') == 'Reject'){
                                    logger.log("ID: "+execution.getVariable('bpm_case_id')+" Marked for: Return to Create Case");
                                    bpm_package.children[i].properties['cts:assignedUnit'] = execution.getVariable('bpm_reject_initial_create_unit');
                                    bpm_package.children[i].properties['cts:assignedTeam'] = execution.getVariable('bpm_reject_initial_create_team');
                                    bpm_package.children[i].properties['cts:assignedUser'] = execution.getVariable('bpm_reject_initial_create_user');
                                    execution.setVariable('bpm_outcome', 'Return');
                                } else {
                                   logger.log("ID: "+execution.getVariable('bpm_case_id')+" Marked for: QA Review");
                                   execution.setVariable('bpm_outcome', 'SendInitialDraftForHoldOutcome');
                                }
                            }]]></activiti:string>
                    </activiti:field>
                </activiti:taskListener>
            </extensionElements>
        </userTask>
        <sequenceFlow id="SendToDraftResponseGateway" sourceRef="DraftResponse" targetRef="DraftResponseGateway" />
        <exclusiveGateway id="DraftResponseGateway" />
        <sequenceFlow id="ReturnToCreate" name="Reject" sourceRef="DraftResponseGateway" targetRef="CreateCase">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(bpm_outcome == 'SendToCreate')}]]></conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="SendToHoldOutcome" sourceRef="DraftResponseGateway" targetRef="HoldOutcome">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(bpm_outcome == 'SendInitialDraftForHoldOutcome')}]]></conditionExpression>
        </sequenceFlow>
        <userTask id="HoldOutcome" name="Hold Outcome" activiti:formKey="wf:adhocTask">
            <extensionElements>
                <activiti:taskListener event="create" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
                    <activiti:field name="runAs">
                        <activiti:string><![CDATA[admin]]></activiti:string>
                    </activiti:field>
                    <activiti:field name="script">
                        <activiti:string><![CDATA[logger.log("ID: "+execution.getVariable('bpm_case_id')+" Sending to stage: Hold Outcome");
                            task.setVariableLocal('bpm_outcomePropertyName',qn.getQname('{http://cts-beta.homeoffice.gov.uk/model/content/1.0}draftResponse'));
                            execution.setVariable('bpm_outcomePropertyName',qn.getQname('{http://cts-beta.homeoffice.gov.uk/model/content/1.0}draftResponse'));
                            for (var i = 0; i < bpm_package.children.length; i++) {
                                bpm_package.children[i].properties['cts:caseStatus'] = 'Hold';
                                bpm_package.children[i].properties['cts:caseTask'] = 'ICO or tribunal outcome';
                                //set owner to admin so that users don't keep edit permissions
                                bpm_package.children[i].setOwner('admin');
                                bpm_package.children[i].properties['cts:caseWorkflowStatus'] = '{"transitions":[{"label":"Reallocate","value": "Reallocate","manualAllocate": true,"allocateHeader": "Reallocate","colour": "green"},{"label":"Recorded","value": "Next","manualAllocate": false, "allocateHeader": "","colour": "green"},{"label":"Return","value": "Reject","manualAllocate": false,"allocateHeader": "Return case","colour": "red"}]}';
                                bpm_package.children[i].save();
                            }]]></activiti:string>
                    </activiti:field>
                </activiti:taskListener>
                <activiti:taskListener event="complete" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
                    <activiti:field name="script">
                        <activiti:string><![CDATA[
                            for (var i = 0; i < bpm_package.children.length; i++) {
                                if (task.getVariableLocal('cts_draftResponse') == 'Reject') {
                                    logger.log("ID: "+execution.getVariable('bpm_case_id')+" Marked for: Return to Draft Response");
                                    execution.setVariable('bpm_outcome', 'Return');
                                    bpm_package.children[i].properties['cts:caseStatus'] = 'Draft';
                                    bpm_package.children[i].properties['cts:caseTask'] = 'Amend response';
                                    bpm_package.children[i].properties['cts:assignedUnit'] = execution.getVariable('bpm_reject_initial_draft_unit');
                                    bpm_package.children[i].properties['cts:assignedTeam'] = execution.getVariable('bpm_reject_initial_draft_team');
                                    bpm_package.children[i].properties['cts:assignedUser'] = execution.getVariable('bpm_reject_initial_draft_user');
                                    bpm_package.children[i].save();
                                } else {
                                    logger.log("ID: "+execution.getVariable('bpm_case_id')+" Marked for: Complete");
                                    execution.setVariable('bpm_outcome', 'Complete');
                                }
                            }]]></activiti:string>
                    </activiti:field>
                </activiti:taskListener>
            </extensionElements>
        </userTask>
        <sequenceFlow id="SendToHoldOutcomeGateway" sourceRef="HoldOutcome" targetRef="HoldOutcomeGateway" />
        <exclusiveGateway id="HoldOutcomeGateway" />
        <sequenceFlow id="ReturnToDraftResponse" name="Reject" sourceRef="HoldOutcomeGateway" targetRef="DraftResponse">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(bpm_outcome == 'Return')}]]></conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="SendToComplete" sourceRef="HoldOutcomeGateway" targetRef="EndEvent">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(bpm_outcome == 'Complete')}]]></conditionExpression>
        </sequenceFlow>
        <userTask id="NRR" name="No Response Required">
            <extensionElements>
                <activiti:taskListener event="create" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
                    <activiti:field name="runAs">
                        <activiti:string><![CDATA[admin]]></activiti:string>
                    </activiti:field>
                    <activiti:field name="script">
                        <activiti:string><![CDATA[logger.log("ID: "+execution.getVariable('bpm_case_id')+" Sending to stage: No Response Required");
                            task.setVariableLocal('bpm_outcomePropertyName',qn.getQname('{http://cts-beta.homeoffice.gov.uk/model/content/1.0}draftResponse'));
                            execution.setVariable('bpm_outcomePropertyName',qn.getQname('{http://cts-beta.homeoffice.gov.uk/model/content/1.0}draftResponse'));
                            for (var i = 0; i < bpm_package.children.length; i++) {
                                bpm_package.children[i].properties['cts:caseStatus'] = 'NFA';
                                bpm_package.children[i].properties['cts:caseTask'] = 'QA';
                                bpm_package.children[i].properties['cts:assignedUnit'] = 'GROUP_FOI';
                                bpm_package.children[i].properties['cts:assignedTeam'] = 'GROUP_FOI_INFORMATION_RIGHTS_TEAM';
                                bpm_package.children[i].properties['cts:assignedUser'] = null;
                                //set owner to admin so that users don't keep edit permissions
                                bpm_package.children[i].setOwner('admin');
                                bpm_package.children[i].properties['cts:caseWorkflowStatus'] = '{"transitions":[{"label":"Reallocate","value": "Reallocate","manualAllocate": true,"allocateHeader": "Reallocate","colour": "green"},{"label":"Approve","value": "ApproveNRR","manualAllocate": false, "allocateHeader": "","colour": "green"},{"label":"Return","value": "Reject","manualAllocate": false,"allocateHeader": "Return case","colour": "red"}]}';
                                bpm_package.children[i].save();
                            }]]></activiti:string>
                    </activiti:field>
                </activiti:taskListener>
                <activiti:taskListener event="complete" class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
                    <activiti:field name="script">
                        <activiti:string><![CDATA[
                            var approved = (task.getVariableLocal('cts_draftResponse') == 'ApproveNRR');
                            if(approved){
                                execution.setVariable('bpm_outcome', 'Complete');
                                for (var i = 0; i < bpm_package.children.length; i++) {
                                    bpm_package.children[i].properties['cts:caseStatus'] = 'Completed';
                                    bpm_package.children[i].properties['cts:caseTask'] = 'None';
                                    bpm_package.children[i].properties['cts:assignedUser'] = null;
                                    bpm_package.children[i].properties['cts:assignedTeam'] = null;
                                    bpm_package.children[i].properties['cts:assignedUnit'] = null;
                                    bpm_package.children[i].properties['cts:caseWorkflowStatus'] = null;
                                    bpm_package.children[i].save();
                                }
                            } else {
                                logger.log("ID: "+execution.getVariable('bpm_case_id')+" Marked for: Return to Initial Draft");
                                execution.setVariable('bpm_outcome', 'Return');
                                for (var i = 0; i < bpm_package.children.length; i++) {
                                    bpm_package.children[i].properties['cts:caseStatus'] = 'Draft';
                                    bpm_package.children[i].properties['cts:caseTask'] = 'Amend response';
                                    bpm_package.children[i].properties['cts:assignedUnit'] = execution.getVariable('bpm_reject_initial_create_unit');
                                    bpm_package.children[i].properties['cts:assignedTeam'] = execution.getVariable('bpm_reject_initial_create_team');
                                    bpm_package.children[i].properties['cts:assignedUser'] = execution.getVariable('bpm_reject_initial_create_user');
                                    bpm_package.children[i].save();
                                }
                            }]]>
                        </activiti:string>
                    </activiti:field>
                </activiti:taskListener>
            </extensionElements>
        </userTask>
        <sequenceFlow id="SendToNRRGateway" sourceRef="NRR" targetRef="NRRGateway" />
        <exclusiveGateway id="NRRGateway" />
        <sequenceFlow id="ReturnNRRToCreate" name="Reject" sourceRef="NRRGateway" targetRef="CreateCase">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(bpm_outcome == 'Return')}]]></conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="SendNRRToComplete" sourceRef="NRRGateway" targetRef="EndEvent">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(bpm_outcome == 'Complete')}]]></conditionExpression>
        </sequenceFlow>
        <userTask id="OGD" name="Refer To DCU">
            <extensionElements>
                <activiti:taskListener event="create"
                                       class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
                    <activiti:field name="runAs">
                        <activiti:string><![CDATA[admin]]></activiti:string>
                    </activiti:field>
                    <activiti:field name="script">
                        <activiti:string><![CDATA[logger.log("ID: "+execution.getVariable('bpm_case_id')+" Sending to stage: Other Government Department");
                            task.setVariableLocal('bpm_outcomePropertyName',qn.getQname('{http://cts-beta.homeoffice.gov.uk/model/content/1.0}draftResponse'));
                            execution.setVariable('bpm_outcomePropertyName',qn.getQname('{http://cts-beta.homeoffice.gov.uk/model/content/1.0}draftResponse'));
                            for (var i = 0; i < bpm_package.children.length; i++) {
                                bpm_package.children[i].properties['cts:caseStatus'] = 'OGD';
                                bpm_package.children[i].properties['cts:caseTask'] = 'Transfer';
                                bpm_package.children[i].properties['cts:assignedUnit'] = 'GROUP_FOI';
                                bpm_package.children[i].properties['cts:assignedTeam'] = 'GROUP_FOI_INFORMATION_RIGHTS_TEAM';
                                bpm_package.children[i].properties['cts:assignedUser'] = null;
                                //set owner to admin so that users don't keep edit permissions
                                bpm_package.children[i].setOwner('admin');
                                bpm_package.children[i].properties['cts:caseWorkflowStatus'] = '{"transitions":[{"label":"Reallocate","value": "Reallocate","manualAllocate": true,"allocateHeader": "Reallocate","colour": "green"},{"label":"Approve","value": "ApproveNRR","manualAllocate": false, "allocateHeader": "","colour": "green"},{"label":"Return","value": "Reject","manualAllocate": false,"allocateHeader": "Return case","colour": "red"}]}';
                                bpm_package.children[i].save();
                            }]]></activiti:string>
                    </activiti:field>
                </activiti:taskListener>
                <activiti:taskListener event="complete"
                                       class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener">
                    <activiti:field name="script">
                        <activiti:string><![CDATA[
                            var approved = (task.getVariableLocal('cts_draftResponse') == 'ApproveNRR');
                            if(approved){
                                execution.setVariable('bpm_outcome', 'Complete');
                                for (var i = 0; i < bpm_package.children.length; i++) {
                                    bpm_package.children[i].properties['cts:caseStatus'] = 'Completed';
                                    bpm_package.children[i].properties['cts:caseTask'] = 'None';
                                    bpm_package.children[i].properties['cts:assignedUser'] = null;
                                    bpm_package.children[i].properties['cts:assignedTeam'] = null;
                                    bpm_package.children[i].properties['cts:assignedUnit'] = null;
                                    bpm_package.children[i].properties['cts:caseWorkflowStatus'] = null;
                                    bpm_package.children[i].save();
                                }
                            } else {
                                logger.log("ID: "+execution.getVariable('bpm_case_id')+" Marked for: Return to Initial Draft");
                                execution.setVariable('bpm_outcome', 'Return');
                                for (var i = 0; i < bpm_package.children.length; i++) {
                                    bpm_package.children[i].properties['cts:caseStatus'] = 'Draft';
                                    bpm_package.children[i].properties['cts:caseTask'] = 'Amend response';
                                    bpm_package.children[i].properties['cts:assignedUnit'] = execution.getVariable('bpm_reject_initial_create_unit');
                                    bpm_package.children[i].properties['cts:assignedTeam'] = execution.getVariable('bpm_reject_initial_create_team');
                                    bpm_package.children[i].properties['cts:assignedUser'] = execution.getVariable('bpm_reject_initial_create_user');
                                    bpm_package.children[i].save();
                                }
                            }]]>
                        </activiti:string>
                    </activiti:field>
                </activiti:taskListener>
            </extensionElements>
        </userTask>
        <sequenceFlow id="SendToOGDGateway" sourceRef="OGD" targetRef="OGDGateway" />
        <exclusiveGateway id="OGDGateway"/>
        <sequenceFlow id="ReturnOGDToCreate" name="Reject" sourceRef="OGDGateway" targetRef="CreateCase">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(bpm_outcome == 'Return')}]]></conditionExpression>
        </sequenceFlow>
        <sequenceFlow id="SendOGDToComplete" sourceRef="OGDGateway" targetRef="EndEvent">
            <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(bpm_outcome == 'Complete')}]]></conditionExpression>
        </sequenceFlow>
        <endEvent id="EndEvent"/>
    </process>
    <bpmndi:BPMNDiagram id="BPMNDiagram_1">
        <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="FOI_Tribunal">
            <bpmndi:BPMNShape id="FOI_di" bpmnElement="FOI">
                <omgdc:Bounds x="123" y="-161" width="757" height="579" />
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
                <omgdc:Bounds x="173" y="102" width="36" height="36" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="146" y="138" width="90" height="20" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape id="CreateCaseGateway_di" bpmnElement="CreateCaseGateway" isMarkerVisible="true">
                <omgdc:Bounds x="422" y="95" width="50" height="50" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="447" y="148" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape id="DraftResponseGateway_di" bpmnElement="DraftResponseGateway" isMarkerVisible="true">
                <omgdc:Bounds x="422" y="333" width="50" height="50" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="447" y="386" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape id="HoldOutcomeGateway_di" bpmnElement="HoldOutcomeGateway" isMarkerVisible="true">
                <omgdc:Bounds x="693" y="333" width="50" height="50" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="718" y="386" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape id="EndEvent_di" bpmnElement="EndEvent">
                <omgdc:Bounds x="807" y="102" width="36" height="36" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="825" y="141" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNEdge id="SendToCreateCase_di" bpmnElement="SendToCreateCase">
                <omgdi:waypoint xsi:type="omgdc:Point" x="209" y="120" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="255" y="120" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="232" y="98.5" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="ReturnToCreate_di" bpmnElement="ReturnToCreate">
                <omgdi:waypoint xsi:type="omgdc:Point" x="422" y="358" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="305" y="358" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="305" y="160" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="348" y="337" width="32" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="SendToCreateCaseGateway_di" bpmnElement="SendToCreateCaseGateway">
                <omgdi:waypoint xsi:type="omgdc:Point" x="355" y="120" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="422" y="120" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="388.5" y="98.5" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="SendToDraftResponse_di" bpmnElement="SendToDraftResponse">
                <omgdi:waypoint xsi:type="omgdc:Point" x="447" y="145" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="447" y="201" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="462" y="166.5" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="SendToNRR_di" bpmnElement="SendToNRR">
                <omgdi:waypoint xsi:type="omgdc:Point" x="472" y="120" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="544" y="120" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="508" y="98.5" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="ReturnToDraftResponse_di" bpmnElement="ReturnToDraftResponse">
                <omgdi:waypoint xsi:type="omgdc:Point" x="718" y="333" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="718" y="241" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="497" y="241" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="578" y="216" width="32" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="SendToDraftResponseGateway_di" bpmnElement="SendToDraftResponseGateway">
                <omgdi:waypoint xsi:type="omgdc:Point" x="447" y="281" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="447" y="333" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="462" y="300.5" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="SendToHoldOutcome_di" bpmnElement="SendToHoldOutcome">
                <omgdi:waypoint xsi:type="omgdc:Point" x="472" y="358" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="508" y="358" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="508" y="358" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="544" y="358" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="523" y="351.5" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="SendToHoldOutcomeGateway_di" bpmnElement="SendToHoldOutcomeGateway">
                <omgdi:waypoint xsi:type="omgdc:Point" x="644" y="358" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="693" y="358" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="668.5" y="336.5" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="SendToComplete_di" bpmnElement="SendToComplete">
                <omgdi:waypoint xsi:type="omgdc:Point" x="743" y="358" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="825" y="358" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="825" y="138" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="784" y="336.5" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNShape id="UserTask_0lndm5u_di" bpmnElement="CreateCase">
                <omgdc:Bounds x="255" y="80" width="100" height="80" />
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape id="UserTask_1lk12qj_di" bpmnElement="DraftResponse">
                <omgdc:Bounds x="397" y="201" width="100" height="80" />
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape id="UserTask_0koaiyp_di" bpmnElement="HoldOutcome">
                <omgdc:Bounds x="544" y="318" width="100" height="80" />
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape id="UserTask_0k3bxk9_di" bpmnElement="NRR">
                <omgdc:Bounds x="544" y="80" width="100" height="80" />
            </bpmndi:BPMNShape>
            <bpmndi:BPMNShape id="NRRGateway_di" bpmnElement="NRRGateway" isMarkerVisible="true">
                <omgdc:Bounds x="693.2914979757085" y="95" width="50" height="50" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="718.2914979757085" y="148" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNEdge id="ReturnNRRToCreate_di" bpmnElement="ReturnNRRToCreate">
                <omgdi:waypoint xsi:type="omgdc:Point" x="718" y="95" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="718" y="37" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="305" y="37" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="305" y="80" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="496" y="16" width="32" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="SendToNRRGateway_di" bpmnElement="SendToNRRGateway">
                <omgdi:waypoint xsi:type="omgdc:Point" x="644" y="120" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="693" y="120" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="668.5" y="98.5" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="SendNRRToComplete_di" bpmnElement="SendNRRToComplete">
                <omgdi:waypoint xsi:type="omgdc:Point" x="743" y="120" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="807" y="120" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="775" y="98.5" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="SendToOGD_di" bpmnElement="SendToOGD">
                <omgdi:waypoint xsi:type="omgdc:Point" x="447" y="95" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="447" y="-46" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="544" y="-46" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="462" y="18" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNShape id="OGDGateway_di" bpmnElement="OGDGateway" isMarkerVisible="true">
                <omgdc:Bounds x="693" y="-71" width="50" height="50" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="718" y="-18" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNShape>
            <bpmndi:BPMNEdge id="SendToOGDGateway_di" bpmnElement="SendToOGDGateway">
                <omgdi:waypoint xsi:type="omgdc:Point" x="644" y="-46" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="693" y="-46" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="668.5" y="-67.5" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNEdge id="SendOGDToComplete_di" bpmnElement="SendOGDToComplete">
                <omgdi:waypoint xsi:type="omgdc:Point" x="743" y="-46" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="825" y="-46" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="825" y="102" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="784" y="-67.5" width="0" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
            <bpmndi:BPMNShape id="UserTask_0sbix7k_di" bpmnElement="OGD">
                <omgdc:Bounds x="544" y="-86" width="100" height="80" />
            </bpmndi:BPMNShape>
            <bpmndi:BPMNEdge id="ReturnOGDToCreate_di" bpmnElement="ReturnOGDToCreate">
                <omgdi:waypoint xsi:type="omgdc:Point" x="718" y="-71" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="718" y="-120" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="305" y="-120" />
                <omgdi:waypoint xsi:type="omgdc:Point" x="305" y="80" />
                <bpmndi:BPMNLabel>
                    <omgdc:Bounds x="496" y="-141" width="32" height="13" />
                </bpmndi:BPMNLabel>
            </bpmndi:BPMNEdge>
        </bpmndi:BPMNPlane>
    </bpmndi:BPMNDiagram>
</definitions>
